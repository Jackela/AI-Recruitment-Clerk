{
  "id": "CODE-003",
  "title": "Phase 4: File Size Reduction (Atomic Stories)",
  "description": "Split large files into smaller modules following the <500 line limit. Each story is atomic and verifiable.",
  "acceptanceCriteria": [
    "All targeted files < 500 lines",
    "npm run typecheck passes",
    "npm run test passes"
  ],
  "priority": 1,
  "branchName": "refactor/code-cleanup",
  "subtasks": [
    {
      "id": "CODE-003-1",
      "title": "Extract mobile-navigation header template",
      "description": "Extract the header section (logo, title, menu button) from mobile-navigation.component.ts into mobile-navigation-header.component.ts. Use @Input for title, @Output for menuToggle event.",
      "acceptanceCriteria": [
        "mobile-navigation.component.ts line count < 550",
        "mobile-navigation-header.component.ts exists",
        "npm run typecheck passes",
        "npm run test -- --testPathPattern=mobile-navigation passes"
      ],
      "pattern": "Component splitting: extract UI section to child component with @Input/@Output",
      "files": [
        "apps/ai-recruitment-frontend/src/app/components/mobile/mobile-navigation.component.ts",
        "apps/ai-recruitment-frontend/src/app/components/mobile/mobile-navigation-header.component.ts"
      ],
      "passes": true
    },
    {
      "id": "CODE-003-2",
      "title": "Extract mobile-navigation bottom nav",
      "description": "Extract the bottom navigation bar section from mobile-navigation.component.ts into mobile-bottom-nav.component.ts. Include nav items array and active state logic.",
      "acceptanceCriteria": [
        "mobile-navigation.component.ts line count < 450",
        "mobile-bottom-nav.component.ts exists",
        "npm run typecheck passes",
        "npm run test -- --testPathPattern=mobile-navigation passes"
      ],
      "pattern": "Component splitting: extract navigation UI to child component",
      "files": [
        "apps/ai-recruitment-frontend/src/app/components/mobile/mobile-navigation.component.ts",
        "apps/ai-recruitment-frontend/src/app/components/mobile/mobile-bottom-nav.component.ts"
      ],
      "passes": true
    },
    {
      "id": "CODE-003-3",
      "title": "Extract candidate card display from results-item",
      "description": "Extract the candidate info display (avatar, name, title, company) from mobile-results-item.component.ts into mobile-candidate-card.component.ts. Keep swipe logic in original file.",
      "acceptanceCriteria": [
        "mobile-results-item.component.ts line count < 400",
        "mobile-candidate-card.component.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "Component splitting: extract display-only UI to child component",
      "files": [
        "apps/ai-recruitment-frontend/src/app/components/mobile/mobile-results-item.component.ts",
        "apps/ai-recruitment-frontend/src/app/components/mobile/mobile-candidate-card.component.ts"
      ],
      "passes": true
    },
    {
      "id": "CODE-003-4",
      "title": "Extract skill tags display from results-item",
      "description": "Extract the skill tags/chips display from mobile-results-item.component.ts into mobile-skill-tags.component.ts. Use @Input for skills array.",
      "acceptanceCriteria": [
        "mobile-results-item.component.ts line count < 350",
        "mobile-skill-tags.component.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "Component splitting: extract repeated UI pattern to reusable component",
      "files": [
        "apps/ai-recruitment-frontend/src/app/components/mobile/mobile-results-item.component.ts",
        "apps/ai-recruitment-frontend/src/app/components/mobile/mobile-skill-tags.component.ts"
      ],
      "passes": true
    },
    {
      "id": "CODE-003-5",
      "title": "Extract data-table inline template to HTML",
      "description": "Move the inline template from data-table.component.ts to external data-table.component.html file. Use templateUrl in @Component decorator.",
      "acceptanceCriteria": [
        "data-table.component.ts line count < 600",
        "data-table.component.html exists",
        "npm run typecheck passes"
      ],
      "pattern": "Template extraction: move inline template to external .html file",
      "files": [
        "apps/ai-recruitment-frontend/src/app/components/shared/data-table/data-table.component.ts",
        "apps/ai-recruitment-frontend/src/app/components/shared/data-table/data-table.component.html"
      ],
      "passes": true
    },
    {
      "id": "CODE-003-6",
      "title": "Extract data-table pagination component",
      "description": "Extract pagination controls (page numbers, prev/next buttons, page size selector) from data-table.component.ts to data-table-pagination.component.ts. Use @Input for totalItems/pageSize/pageIndex, @Output for pageChange.",
      "acceptanceCriteria": [
        "data-table.component.ts line count < 450",
        "data-table-pagination.component.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "Component splitting: extract pagination UI to child component",
      "files": [
        "apps/ai-recruitment-frontend/src/app/components/shared/data-table/data-table.component.ts",
        "apps/ai-recruitment-frontend/src/app/components/shared/data-table/data-table-pagination.component.ts"
      ],
      "passes": true
    },
    {
      "id": "CODE-003-7",
      "title": "Extract data-table sorting service",
      "description": "Extract sorting logic (sort function, sort direction cycling, multi-column sort) from data-table.component.ts to data-table-sorting.service.ts. Use DataTableUtilService pattern already in codebase.",
      "acceptanceCriteria": [
        "data-table.component.ts line count < 350",
        "data-table-sorting.service.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "Service extraction: move business logic to service",
      "files": [
        "apps/ai-recruitment-frontend/src/app/components/shared/data-table/data-table.component.ts",
        "apps/ai-recruitment-frontend/src/app/components/shared/data-table/data-table-sorting.service.ts"
      ],
      "passes": false
    },
    {
      "id": "CODE-003-8",
      "title": "Extract analytics value objects",
      "description": "Extract all value object classes (AnalyticsEventId, UserSession, DeviceInfo, GeoLocation, etc.) from analytics.dto.ts to analytics-value-objects.dto.ts. Re-export from main file for backward compatibility.",
      "acceptanceCriteria": [
        "analytics.dto.ts line count < 900",
        "analytics-value-objects.dto.ts exists",
        "npm run typecheck passes",
        "All imports from analytics.dto.ts still work"
      ],
      "pattern": "DTO splitting: extract value objects, re-export from barrel file",
      "files": [
        "libs/shared-dtos/src/domains/analytics.dto.ts",
        "libs/shared-dtos/src/domains/analytics-value-objects.dto.ts",
        "libs/shared-dtos/src/index.ts"
      ],
      "passes": false
    },
    {
      "id": "CODE-003-9",
      "title": "Extract analytics interfaces",
      "description": "Extract all interface definitions (IAnalyticsRepository, IDomainEventBus, IAuditLogger, etc.) from analytics.dto.ts to analytics-interfaces.dto.ts. Use type-only imports where possible.",
      "acceptanceCriteria": [
        "analytics.dto.ts line count < 700",
        "analytics-interfaces.dto.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "DTO splitting: extract interfaces to separate file",
      "files": [
        "libs/shared-dtos/src/domains/analytics.dto.ts",
        "libs/shared-dtos/src/domains/analytics-interfaces.dto.ts"
      ],
      "passes": false
    },
    {
      "id": "CODE-003-10",
      "title": "Extract analytics result classes",
      "description": "Extract all result class definitions (EventCreationResult, BatchProcessingResult, etc.) from analytics.dto.ts to analytics-results.dto.ts. Re-export from main file.",
      "acceptanceCriteria": [
        "analytics.dto.ts line count < 500",
        "analytics-results.dto.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "DTO splitting: extract result classes, maintain barrel export",
      "files": [
        "libs/shared-dtos/src/domains/analytics.dto.ts",
        "libs/shared-dtos/src/domains/analytics-results.dto.ts"
      ],
      "passes": false
    },
    {
      "id": "CODE-003-11",
      "title": "Extract questionnaire validation logic",
      "description": "Extract validation functions and types (validateQuestionnaire, ValidationRule, etc.) from questionnaire.dto.ts to questionnaire-validation.dto.ts.",
      "acceptanceCriteria": [
        "questionnaire.dto.ts line count < 800",
        "questionnaire-validation.dto.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "DTO splitting: extract validation logic to separate file",
      "files": [
        "libs/shared-dtos/src/domains/questionnaire.dto.ts",
        "libs/shared-dtos/src/domains/questionnaire-validation.dto.ts"
      ],
      "passes": false
    },
    {
      "id": "CODE-003-12",
      "title": "Extract questionnaire response DTOs",
      "description": "Extract response-related DTOs (QuestionnaireResponseDto, QuestionnaireAnalyticsDto, etc.) from questionnaire.dto.ts to questionnaire-responses.dto.ts.",
      "acceptanceCriteria": [
        "questionnaire.dto.ts line count < 600",
        "questionnaire-responses.dto.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "DTO splitting: extract response DTOs",
      "files": [
        "libs/shared-dtos/src/domains/questionnaire.dto.ts",
        "libs/shared-dtos/src/domains/questionnaire-responses.dto.ts"
      ],
      "passes": false
    },
    {
      "id": "CODE-003-13",
      "title": "Extract questionnaire question definitions",
      "description": "Extract question definition types (QuestionSection, QuestionDefinition, etc.) from questionnaire.dto.ts to questionnaire-questions.dto.ts.",
      "acceptanceCriteria": [
        "questionnaire.dto.ts line count < 500",
        "questionnaire-questions.dto.ts exists",
        "npm run typecheck passes"
      ],
      "pattern": "DTO splitting: extract domain types",
      "files": [
        "libs/shared-dtos/src/domains/questionnaire.dto.ts",
        "libs/shared-dtos/src/domains/questionnaire-questions.dto.ts"
      ],
      "passes": false
    }
  ]
}
