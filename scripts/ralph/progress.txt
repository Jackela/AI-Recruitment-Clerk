# Ralph Progress Log
Started: 2026-02-04
---

## 2026-02-04 - US-001
- Created docs/ARCHITECTURE_BASELINE.md with architectural layers and dependency rules
- Documented module boundary tags (type:app, scope:shared, scope:domain, layer:contracts, type:utils)
- Added ASCII diagram showing layer hierarchy and data flow
- Defined DDD structure for domain libraries (domain/application/infrastructure)
- Documented service base class pattern and NATS microservice conventions
- Files changed: docs/ARCHITECTURE_BASELINE.md (new)

**Learnings for future iterations:**
- The project uses ESLint `@nx/enforce-module-boundaries` for dependency rules - check eslint.config.mjs for current tag definitions
- Domain libraries follow DDD structure with /domain (entities, VOs, events), /application (commands, queries, handlers), /infrastructure (persistence, messaging, APIs)
- All NATS microservices extend BaseMicroserviceService from @ai-recruitment-clerk/service-base
- Environment validation uses @ai-recruitment-clerk/configuration
- Shared libs (scope:shared) can only depend on other shared libs or type:utils
- Domain libs (scope:domain) can depend on shared, utils, contracts, and other domains
---

## 2026-02-04 - US-002
- Added consistent tags to all Nx projects in project.json files
- Tagged 6 microservice apps with type:app (app-gateway, resume-parser-svc, jd-extractor-svc, scoring-engine-svc, report-generator-svc, ai-recruitment-frontend)
- Tagged 2 e2e projects with type:e2e
- Standardized shared library tags: type:lib → type:utils, type:util → type:utils, type:base → type:utils, type:types → type:utils
- Removed non-standard layer tags (layer:infrastructure, layer:ai-services) to match documented convention
- Domain libs remain tagged as scope:domain, type:lib with domain:{name} specific tags
- api-contracts keeps layer:contracts tag
- Files changed: 14 project.json files (apps/ and libs/)

**Learnings for future iterations:**
- ESLint enforce-module-boundaries rule in eslint.config.mjs expects specific tag patterns: type:app, scope:shared, scope:domain, layer:contracts, type:utils
- Non-standard tags like type:lib, type:base, type:types, type:util, layer:infrastructure, layer:ai-services don't match the documented convention
- Always check ARCHITECTURE_BASELINE.md for the authoritative tag reference before making changes
- Domain libraries use three tags: domain:{name}, scope:domain, type:lib (keep these consistent)
- Shared infrastructure libraries should use: scope:shared, type:utils (minimal, enforceable)
---

## 2026-02-04 - US-003
- Added explicit forbidden dependency rules to eslint.config.mjs using notDependOnLibsWithTags
- Added 3 forbidden dependency rules:
  1. scope:shared → not depend on scope:domain, layer:contracts (prevents circular deps)
  2. scope:domain → not depend on type:app (ensures business logic remains independent)
  3. layer:contracts → not depend on scope:domain, scope:shared (keeps contracts stable)
- Fixed boundary violation: removed unused infrastructure-shared/src/contracts/index.ts re-export file
- Files changed: eslint.config.mjs, libs/infrastructure-shared/src/contracts/index.ts (deleted)

**Learnings for future iterations:**
- ESLint @nx/enforce-module-boundaries supports both onlyDependOnLibsWithTags (allowlist) and notDependOnLibsWithTags (denylist)
- Use notDependOnLibsWithTags for explicit architectural violations that should error
- Re-export files in shared libraries can create hidden dependencies on layers they shouldn't depend on
- Always verify boundary rules catch real violations - the contracts/index.ts file was unused but violated the rule
- When adding boundary rules, run lint and fix violations immediately to avoid tech debt accumulation
---
