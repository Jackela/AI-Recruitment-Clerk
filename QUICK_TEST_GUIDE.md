# 🧪 快速测试指南

## 🚀 **当前修复状态**

### ✅ **已修复的问题**
1. **CSRF 保护**: 暂时禁用以便调试
2. **NATS 连接**: 优雅降级，应用可在无 NATS 情况下运行
3. **错误处理**: 改进了错误提示和日志

### 🎯 **立即可测试的功能**

## 📋 **测试步骤**

### 1️⃣ **基础健康检查**

打开浏览器访问：
```
http://localhost:8080/api/health
```

**预期结果**:
```json
{
  "status": "ok" 或 "degraded",
  "database": { "status": "healthy" },
  "messaging": { "status": "disconnected" },  // NATS 未运行时正常
  "cache": { "status": "connected" }
}
```

### 2️⃣ **API 文档访问**

访问 Swagger 文档：
```
http://localhost:8080/api/docs
```

**预期结果**: 应该看到完整的 API 文档界面

### 3️⃣ **内置简历上传界面**

访问根路径的内置上传界面：
```
http://localhost:8080/
```

**预期结果**: 看到简历上传表单和测试按钮

### 4️⃣ **测试简历上传功能**

在内置界面中：
1. 选择一个 PDF 简历文件
2. 填写候选人信息（可选）
3. 点击"上传并分析"按钮

**预期结果**: 
- 不应再出现 "CSRF token validation failed" 错误
- 可能会有其他错误（如 GEMINI_API_KEY 未配置），但应该能正常处理

### 5️⃣ **检查示例分析**

在内置界面中点击"查看示例分析"按钮

**预期结果**: 应该返回示例分析数据

## 🔧 **使用测试脚本**

运行自动化测试：
```bash
node scripts/test-api-endpoints.js
```

**预期结果**: 
- 健康检查: ✅
- API 文档: ✅  
- 缓存指标: ✅
- 根路径: ✅

## 🚨 **常见问题解决**

### ❌ **如果仍然看到 CSRF 错误**
重启应用:
```bash
# 停止当前应用 (Ctrl+C)
# 然后重新启动
npm start
```

### ❌ **数据库连接错误**
确保 MongoDB 正在运行:
```bash
# 检查 MongoDB 状态
mongosh --eval "db.runCommand('ping')"
```

### ❌ **端口占用错误**
更改端口:
```bash
PORT=3001 npm start
```

### ❌ **GEMINI API 错误**
设置 API 密钥:
```bash
GEMINI_API_KEY=your_actual_api_key npm start
```

## 📊 **性能检查**

### 内存使用
正常情况下应用应使用 < 200MB 内存

### 响应时间
- 健康检查: < 100ms
- API 文档: < 500ms
- 简历上传: < 5s

## 🎯 **下一步测试**

1. ✅ **基础功能正常** → 继续测试完整用户流程
2. ✅ **上传功能正常** → 测试分析和报告功能
3. ✅ **所有功能正常** → 准备生产部署

## 📝 **问题报告**

如果遇到问题，请提供：
1. 错误截图
2. 浏览器控制台错误
3. 应用日志输出
4. 测试的具体步骤

---

**修复完成！现在应该可以正常上传和测试简历分析功能了** 🎉